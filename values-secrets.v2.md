# Hybrid Cloud Patterns - values-secret.yaml files schema V2

- [1. Property `Values Secrets V2 Format > version`](#version)
- [2. Property `Values Secrets V2 Format > backingStore`](#backingStore)
- [3. Property `Values Secrets V2 Format > vaultPolicies`](#vaultPolicies)
- [4. Property `Values Secrets V2 Format > secrets`](#secrets)
  - [4.1. Values Secrets V2 Format > secrets > Secret](#autogenerated_heading_2)
    - [4.1.1. Property `Values Secrets V2 Format > secrets > secrets items > name`](#secrets_items_name)
    - [4.1.2. Property `Values Secrets V2 Format > secrets > secrets items > vaultMount`](#secrets_items_vaultMount)
    - [4.1.3. Property `Values Secrets V2 Format > secrets > secrets items > vaultPrefixes`](#secrets_items_vaultPrefixes)
      - [4.1.3.1. Values Secrets V2 Format > secrets > secrets items > vaultPrefixes > vaultPrefixes items](#autogenerated_heading_3)
    - [4.1.4. Property `Values Secrets V2 Format > secrets > secrets items > fields`](#secrets_items_fields)
      - [4.1.4.1. Values Secrets V2 Format > secrets > secrets items > fields > Field](#autogenerated_heading_4)
        - [4.1.4.1.1. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > oneOf > item 0`](#secrets_items_fields_items_oneOf_i0)
          - [4.1.4.1.1.1. The following properties are required](#autogenerated_heading_5)
        - [4.1.4.1.2. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > oneOf > item 1`](#secrets_items_fields_items_oneOf_i1)
          - [4.1.4.1.2.1. The following properties are required](#autogenerated_heading_6)
        - [4.1.4.1.3. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > name`](#secrets_items_fields_items_name)
        - [4.1.4.1.4. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > onMissingValue`](#secrets_items_fields_items_onMissingValue)
        - [4.1.4.1.5. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > prompt`](#secrets_items_fields_items_prompt)
        - [4.1.4.1.6. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > value`](#secrets_items_fields_items_value)
        - [4.1.4.1.7. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > path`](#secrets_items_fields_items_path)
        - [4.1.4.1.8. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > vaultPolicy`](#secrets_items_fields_items_vaultPolicy)
        - [4.1.4.1.9. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > base64`](#secrets_items_fields_items_base64)

**Title:** Hybrid Cloud Patterns - values-secret.yaml files schema V2

|                           |                                                         |
| ------------------------- | ------------------------------------------------------- |
| **Type**                  | `object`                                                |
| **Required**              | No                                                      |
| **Additional properties** | [[Not allowed]](# "Additional Properties not allowed.") |
| **Defined in**            | #/definitions/valuesSecretsV2                           |

**Description:** This schema defines the values-secret.yaml file as used by [Validated Patterns](https://hybrid-cloud-patterns.io)

**Example:** 

```yaml
version: '2.0'
backingStore: vault
vaultPolicies:
  basicPolicy: 'length=10

    rule "charset" { charset = "abcdefghijklmnopqrstuvwxyz" min-chars = 1 }

    rule "charset" { charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" min-chars = 1 }

    rule "charset" { charset = "0123456789" min-chars = 1 }

    '
  advancedPolicy: 'length=20

    rule "charset" { charset = "abcdefghijklmnopqrstuvwxyz" min-chars = 1 }

    rule "charset" { charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" min-chars = 1 }

    rule "charset" { charset = "0123456789" min-chars = 1 }

    rule "charset" { charset = "!@#$%^&*" min-chars = 1 }

    '
secrets:
- name: config-demo
  vaultMount: secret
  vaultPrefixes:
  - region-one
  - snowflake.blueprints.rhecoeng.com
  fields:
  - name: secret
    onMissingValue: generate
    vaultPolicy: basicPolicy
  - name: secretprompt
    value: null
    onMissingValue: prompt
    prompt: Please specify the password for application ABC
  - name: secretprompt2
    value: defaultvalue
    onMissingValue: prompt
    prompt: Please specify the API key for XYZ
  - name: secretfile
    path: /tmp/ca.crt
    onMissingValue: prompt
    prompt: Insert path to Certificate Authority
  - name: ca_crt
    path: /tmp/ca.crt
    onMissingValue: error
  - name: ca_crt_b64
    path: /tmp/ca.crt
    base64: true
    onMissingValue: prompt
- name: config-demo2
  vaultPrefixes:
  - region-one
  - snowflake.blueprints.rhecoeng.com
  fields:
  - name: ca_crt2
    path: null
    onMissingValue: prompt
  - name: ca_crt
    path: /tmp/ca.crt
    onMissingValue: error

```

**Example:** 

```yaml
version: '2.0'
backingStore: vault
vaultPolicies:
  basicPolicy: 'length=10

    rule "charset" { charset = "abcdefghijklmnopqrstuvwxyz" min-chars = 1 }

    rule "charset" { charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" min-chars = 1 }

    rule "charset" { charset = "0123456789" min-chars = 1 }

    '
  advancedPolicy: 'length=20

    rule "charset" { charset = "abcdefghijklmnopqrstuvwxyz" min-chars = 1 }

    rule "charset" { charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" min-chars = 1 }

    rule "charset" { charset = "0123456789" min-chars = 1 }

    rule "charset" { charset = "!@#$%^&*" min-chars = 1 }

    '
secrets:
- name: config-demo
  vaultMount: secret
  vaultPrefixes:
  - region-one
  - snowflake.blueprints.rhecoeng.com
  fields:
  - name: secret
    onMissingValue: generate
    vaultPolicy: basicPolicy
  - name: secretprompt
    value: null
    onMissingValue: prompt
    prompt: Please specify the password for application ABC
  - name: secretprompt2
    value: defaultvalue
    onMissingValue: prompt
    prompt: Please specify the API key for XYZ
  - name: secretfile
    path: /tmp/ca.crt
    onMissingValue: prompt
    prompt: Insert path to Certificate Authority
  - name: ca_crt
    path: /tmp/ca.crt
    onMissingValue: error
  - name: ca_crt_b64
    path: /tmp/ca.crt
    base64: true
    onMissingValue: prompt
- name: config-demo2
  vaultPrefixes:
  - region-one
  - snowflake.blueprints.rhecoeng.com
  fields:
  - name: ca_crt2
    path: null
    onMissingValue: prompt
  - name: ca_crt
    path: /tmp/ca.crt
    onMissingValue: error

```

| Property                           | Pattern | Type           | Deprecated | Definition                     | Title/Description                                                 |
| ---------------------------------- | ------- | -------------- | ---------- | ------------------------------ | ----------------------------------------------------------------- |
| - [version](#version )             | No      | string or null | No         | -                              | Version of the secret specification                               |
| - [backingStore](#backingStore )   | No      | string         | No         | -                              | Secrets backing store type                                        |
| - [vaultPolicies](#vaultPolicies ) | No      | object         | No         | In #/definitions/VaultPolicies | A dictionary of {name}:{policy} of custom vault password policies |
| + [secrets](#secrets )             | No      | array          | No         | In #/definitions/Secrets       | The list of actual secrets to be uploaded in the vault            |

## <a name="version"></a>1. Property `Values Secrets V2 Format > version`

|              |                  |
| ------------ | ---------------- |
| **Type**     | `string or null` |
| **Required** | No               |
| **Default**  | `"1.0"`          |

**Description:** Version of the secret specification

## <a name="backingStore"></a>2. Property `Values Secrets V2 Format > backingStore`

|              |           |
| ------------ | --------- |
| **Type**     | `string`  |
| **Required** | No        |
| **Default**  | `"vault"` |

**Description:** Secrets backing store type

## <a name="vaultPolicies"></a>3. Property `Values Secrets V2 Format > vaultPolicies`

|                           |                                                                           |
| ------------------------- | ------------------------------------------------------------------------- |
| **Type**                  | `object`                                                                  |
| **Required**              | No                                                                        |
| **Additional properties** | [[Any type: allowed]](# "Additional Properties of any type are allowed.") |
| **Defined in**            | #/definitions/VaultPolicies                                               |

**Description:** A dictionary of {name}:{policy} of custom vault password policies

**Example:** 

```yaml
vaultPolicies:
  basicPolicy: 'length=10

    rule "charset" { charset = "abcdefghijklmnopqrstuvwxyz" min-chars = 1 }

    rule "charset" { charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" min-chars = 1 }

    rule "charset" { charset = "0123456789" min-chars = 1 }

    '
  advancedPolicy: 'length=20

    rule "charset" { charset = "abcdefghijklmnopqrstuvwxyz" min-chars = 1 }

    rule "charset" { charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" min-chars = 1 }

    rule "charset" { charset = "0123456789" min-chars = 1 }

    rule "charset" { charset = "!@#$%^&*" min-chars = 1 }

    '

```

## <a name="secrets"></a>4. Property `Values Secrets V2 Format > secrets`

|                |                       |
| -------------- | --------------------- |
| **Type**       | `array`               |
| **Required**   | Yes                   |
| **Defined in** | #/definitions/Secrets |

**Description:** The list of actual secrets to be uploaded in the vault

|                      | Array restrictions |
| -------------------- | ------------------ |
| **Min items**        | N/A                |
| **Max items**        | N/A                |
| **Items unicity**    | False              |
| **Additional items** | False              |
| **Tuple validation** | See below          |

| Each item of this array must be | Description                                     |
| ------------------------------- | ----------------------------------------------- |
| [Secret](#secrets_items)        | The single secret to be injected into the vault |

### <a name="autogenerated_heading_2"></a>4.1. Values Secrets V2 Format > secrets > Secret

|                           |                                                         |
| ------------------------- | ------------------------------------------------------- |
| **Type**                  | `object`                                                |
| **Required**              | No                                                      |
| **Additional properties** | [[Not allowed]](# "Additional Properties not allowed.") |
| **Defined in**            | #/definitions/Secret                                    |

**Description:** The single secret to be injected into the vault

| Property                                         | Pattern | Type            | Deprecated | Definition | Title/Description                                                                                                                                   |
| ------------------------------------------------ | ------- | --------------- | ---------- | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| + [name](#secrets_items_name )                   | No      | string          | No         | -          | This is the name of the top level key that will be created at the vaultMount point and that will contain one secret per field inside its attributes |
| - [vaultMount](#secrets_items_vaultMount )       | No      | string          | No         | -          | This is the vault -mount=<...> mount point used in vault commands                                                                                   |
| - [vaultPrefixes](#secrets_items_vaultPrefixes ) | No      | array of string | No         | -          | This is the list of prefixes the secret will be uploaded to                                                                                         |
| + [fields](#secrets_items_fields )               | No      | array of object | No         | -          | This is the list of actual secret material that will be placed in a vault key's attributes                                                          |

#### <a name="secrets_items_name"></a>4.1.1. Property `Values Secrets V2 Format > secrets > secrets items > name`

|              |          |
| ------------ | -------- |
| **Type**     | `string` |
| **Required** | Yes      |

**Description:** This is the name of the top level key that will be created at the vaultMount point and that will contain one secret per field inside its attributes

#### <a name="secrets_items_vaultMount"></a>4.1.2. Property `Values Secrets V2 Format > secrets > secrets items > vaultMount`

|              |            |
| ------------ | ---------- |
| **Type**     | `string`   |
| **Required** | No         |
| **Default**  | `"secret"` |

**Description:** This is the vault -mount=<...> mount point used in vault commands

#### <a name="secrets_items_vaultPrefixes"></a>4.1.3. Property `Values Secrets V2 Format > secrets > secrets items > vaultPrefixes`

|              |                   |
| ------------ | ----------------- |
| **Type**     | `array of string` |
| **Required** | No                |

**Description:** This is the list of prefixes the secret will be uploaded to

|                      | Array restrictions |
| -------------------- | ------------------ |
| **Min items**        | N/A                |
| **Max items**        | N/A                |
| **Items unicity**    | False              |
| **Additional items** | False              |
| **Tuple validation** | See below          |

| Each item of this array must be                           | Description |
| --------------------------------------------------------- | ----------- |
| [vaultPrefixes items](#secrets_items_vaultPrefixes_items) | -           |

##### <a name="autogenerated_heading_3"></a>4.1.3.1. Values Secrets V2 Format > secrets > secrets items > vaultPrefixes > vaultPrefixes items

|              |          |
| ------------ | -------- |
| **Type**     | `string` |
| **Required** | No       |

#### <a name="secrets_items_fields"></a>4.1.4. Property `Values Secrets V2 Format > secrets > secrets items > fields`

|              |                   |
| ------------ | ----------------- |
| **Type**     | `array of object` |
| **Required** | Yes               |

**Description:** This is the list of actual secret material that will be placed in a vault key's attributes

|                      | Array restrictions |
| -------------------- | ------------------ |
| **Min items**        | N/A                |
| **Max items**        | N/A                |
| **Items unicity**    | False              |
| **Additional items** | False              |
| **Tuple validation** | See below          |

| Each item of this array must be      | Description |
| ------------------------------------ | ----------- |
| [Field](#secrets_items_fields_items) | -           |

##### <a name="autogenerated_heading_4"></a>4.1.4.1. Values Secrets V2 Format > secrets > secrets items > fields > Field

|                           |                                                         |
| ------------------------- | ------------------------------------------------------- |
| **Type**                  | `combining`                                             |
| **Required**              | No                                                      |
| **Additional properties** | [[Not allowed]](# "Additional Properties not allowed.") |
| **Defined in**            | #/definitions/Field                                     |

| Property                                                        | Pattern | Type             | Deprecated | Definition | Title/Description                                                                                                                                                                                                                                                                                                                                                               |
| --------------------------------------------------------------- | ------- | ---------------- | ---------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| + [name](#secrets_items_fields_items_name )                     | No      | string           | No         | -          | This is the name of the attribute inside vault                                                                                                                                                                                                                                                                                                                                  |
| + [onMissingValue](#secrets_items_fields_items_onMissingValue ) | No      | enum (of string) | No         | -          | 'error' will generate an error if the secret (via value or via path attributes) are not defined. 'generate' will create a secret using a defined vaultPolicy. 'prompt' will ask the user for input and it requires to set a value or a path depending if the user should input a secret or a path to a secret file. Non-null entries represent the default value when prompted. |
| - [prompt](#secrets_items_fields_items_prompt )                 | No      | string           | No         | -          | Represents the prompt used when onMissingValue is set to prompt                                                                                                                                                                                                                                                                                                                 |
| - [value](#secrets_items_fields_items_value )                   | No      | string or null   | No         | -          | Is the value of a secret. Represents the default value when onMissingValue is set to prompt                                                                                                                                                                                                                                                                                     |
| - [path](#secrets_items_fields_items_path )                     | No      | string or null   | No         | -          | Is the path to a secret file. Represents the default path when onMissingValue is set to prompt                                                                                                                                                                                                                                                                                  |
| - [vaultPolicy](#secrets_items_fields_items_vaultPolicy )       | No      | string           | No         | -          | When onMissingValue is set to 'generate', uses the policy to create the secret inside the vault directly                                                                                                                                                                                                                                                                        |
| - [base64](#secrets_items_fields_items_base64 )                 | No      | boolean          | No         | -          | Before uploading the secret the content is base-64 encoded. It is recommended to set this to true when dealing with files                                                                                                                                                                                                                                                       |

| One of(Option)                                 |
| ---------------------------------------------- |
| [item 0](#secrets_items_fields_items_oneOf_i0) |
| [item 1](#secrets_items_fields_items_oneOf_i1) |

##### <a name="secrets_items_fields_items_oneOf_i0"></a>4.1.4.1.1. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > oneOf > item 0`

|                           |                                                                           |
| ------------------------- | ------------------------------------------------------------------------- |
| **Type**                  | `object`                                                                  |
| **Required**              | No                                                                        |
| **Additional properties** | [[Any type: allowed]](# "Additional Properties of any type are allowed.") |

##### <a name="autogenerated_heading_5"></a>4.1.4.1.1.1. The following properties are required
* path

##### <a name="secrets_items_fields_items_oneOf_i1"></a>4.1.4.1.2. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > oneOf > item 1`

|                           |                                                                           |
| ------------------------- | ------------------------------------------------------------------------- |
| **Type**                  | `object`                                                                  |
| **Required**              | No                                                                        |
| **Additional properties** | [[Any type: allowed]](# "Additional Properties of any type are allowed.") |

##### <a name="autogenerated_heading_6"></a>4.1.4.1.2.1. The following properties are required
* value

##### <a name="secrets_items_fields_items_name"></a>4.1.4.1.3. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > name`

|              |          |
| ------------ | -------- |
| **Type**     | `string` |
| **Required** | Yes      |

**Description:** This is the name of the attribute inside vault

##### <a name="secrets_items_fields_items_onMissingValue"></a>4.1.4.1.4. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > onMissingValue`

|              |                    |
| ------------ | ------------------ |
| **Type**     | `enum (of string)` |
| **Required** | Yes                |

**Description:** 'error' will generate an error if the secret (via value or via path attributes) are not defined. 'generate' will create a secret using a defined vaultPolicy. 'prompt' will ask the user for input and it requires to set a value or a path depending if the user should input a secret or a path to a secret file. Non-null entries represent the default value when prompted.

Must be one of:
* "error"
* "generate"
* "prompt"

##### <a name="secrets_items_fields_items_prompt"></a>4.1.4.1.5. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > prompt`

|              |          |
| ------------ | -------- |
| **Type**     | `string` |
| **Required** | No       |

**Description:** Represents the prompt used when onMissingValue is set to prompt

##### <a name="secrets_items_fields_items_value"></a>4.1.4.1.6. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > value`

|              |                  |
| ------------ | ---------------- |
| **Type**     | `string or null` |
| **Required** | No               |

**Description:** Is the value of a secret. Represents the default value when onMissingValue is set to prompt

##### <a name="secrets_items_fields_items_path"></a>4.1.4.1.7. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > path`

|              |                  |
| ------------ | ---------------- |
| **Type**     | `string or null` |
| **Required** | No               |

**Description:** Is the path to a secret file. Represents the default path when onMissingValue is set to prompt

##### <a name="secrets_items_fields_items_vaultPolicy"></a>4.1.4.1.8. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > vaultPolicy`

|              |          |
| ------------ | -------- |
| **Type**     | `string` |
| **Required** | No       |

**Description:** When onMissingValue is set to 'generate', uses the policy to create the secret inside the vault directly

##### <a name="secrets_items_fields_items_base64"></a>4.1.4.1.9. Property `Values Secrets V2 Format > secrets > secrets items > fields > fields items > base64`

|              |           |
| ------------ | --------- |
| **Type**     | `boolean` |
| **Required** | No        |
| **Default**  | `"false"` |

**Description:** Before uploading the secret the content is base-64 encoded. It is recommended to set this to true when dealing with files

----------------------------------------------------------------------------------------------------------------------------
Generated using [json-schema-for-humans](https://github.com/coveooss/json-schema-for-humans) on 2022-11-24 at 17:05:11 +0100
